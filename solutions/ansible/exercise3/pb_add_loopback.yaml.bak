---
- name: Add Loopback interface to Cisco IOS devices
  hosts: ios
  vars:
    interface_name: Loopback0
  tasks:

    - name: Set Interface IP
      set_fact: 
        interface_ip: "{{ mgmt_subnet | ipaddr(inventory_hostname | regex_search('\\d$')) }}"

    # - name: Print 
    #   debug:
    #     var: interface_ip

    - name: Configure interface IP address
      cisco.ios.ios_l3_interfaces:
        config:
        - name: Loopback0
          ipv4:
          - address: "{{ interface_ip  }}"


# - name: Add Loopback interface to Cisco NXOS devices
#   hosts: nxos
#   vars:
#     interface_name: Loopback0
#   tasks:
#     # - name: Print 
#     #   debug:
#     #     var: mgmt_subnet
    
#     - name: Set Interface IP
#       set_fact: 
#         interface_ip: "{{ mgmt_subnet | ipaddr(inventory_hostname | regex_search('\\d$')) }}"

#     # - name: Print 
#     #   debug:
#     #     var: interface_ip

#     - name: Configure interface IP address
#       cisco.nxos.nxos_l3_interfaces:
#         config:
#         - name: Loopback0
#           ipv4:
#           - address: "{{ interface_ip }}"
#           # - address: interface_ip

# - name: Add Loopback interface to Arista EOS devices
#   hosts: eos
#   vars:
#     interface_name: Loopback0
#   tasks:
#     # - name: Print 
#     #   debug:
#     #     var: mgmt_subnet
    
#     - name: Set Interface IP
#       set_fact: 
#         interface_ip: "{{ mgmt_subnet | ipaddr(inventory_hostname | regex_search('\\d$')) }}"

#     - name: Print 
#       debug:
#         var: interface_ip

#     - name: Configure interface IP address
#       arista.eos.eos_l3_interfaces:
#         config:
#         - name: Loopback0
#           ipv4:
#           # - address: "{{ interface_ip | ipaddr('address') }} {{ interface_ip | ipaddr('netmask') }}"
#           - address: "{{ interface_ip }}"

# - name: Add Loopback interface to Junos VMX devices
#   hosts: vmx
#   gather_facts: false
#   vars:
#     interface_name: Loopback0
#   tasks:
#     # - name: Print 
#     #   debug:
#     #     var: mgmt_subnet
    
#     - name: Set Interface IP
#       set_fact: 
#         interface_ip: "{{ mgmt_subnet | ipaddr(inventory_hostname | regex_search('\\d$')) }}"

#     - name: Print 
#       debug:
#         var: interface_ip

#     - name: Configure interface IP address
#       junipernetworks.junos.junos_l3_interfaces:
#         config:
#         - name: ge-0/0/7
#           ipv4:
#           - address: "{{ interface_ip }}"

